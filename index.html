<!DOCTYPE html>
<html>
<head>
	<title></title>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<script type="text/javascript">
    fetch('https://spreadsheets.google.com/feeds/list/1E-_2LjgSQji5Jb1uy8ShdnmVPPjn9Z-1XJjLpya61UE/1/public/values?alt=json')
      .then(function(response) {
        return response.json();
      })
      .then(function(myJson) {
      	console.log(myJson.feed);
      	build(myJson.feed);
      });
      function build(json) {
      document.title = json.title.$t;
      var profiles = json.entry;
        var row = document.createElement("div");
        row.className = "row";
        var body = document.getElementById("body").appendChild(row); 
      for (var i = 0; i < profiles.length; i++) {
      	if(profiles[i].gsx$break.$t) {
      		row = document.createElement("div");
      		row.className = "row";
        	body = document.getElementById("body").appendChild(row); 
      	}
      	else {
      		row.appendChild(element(profiles[i]));
      	}
      }
      }
      function element(profile) {
  		var element = document.createElement("div");
  		var size;
  		element.className = "col-sm";
  		element.style.color = profile.gsx$color.$t;
  	  	element.style.textAlign = profile.gsx$position.$t;
  	  	element.style.backgroundColor = profile.gsx$background.$t;
  	  	if(profile.gsx$size.$t == 4) {
  	  		size = "h4"
  	  	}
  	  	if(profile.gsx$size.$t == 3) {
  	  		size = "h3"
  	  	}
  	  	if(profile.gsx$size.$t == 2) {
  	  		size = "h2"
  	  	}
  	  	if(profile.gsx$size.$t == 1) {
  	  		size = "h1"
  	  	}
  		var text = document.createElement(size);
  		text.innerHTML = profile.gsx$text.$t;
  		 element.appendChild(text);
  		if(profile.gsx$image.$t) {
  			checkImage(profile.gsx$image.$t, function(){ var img = document.createElement('img');
img.src = profile.gsx$image.$t; img.className = "img-fluid"; element.appendChild(img);}, function(){} );
  		}
  		return element;
      }
     function checkImage(imageSrc, good, bad) {
		var img = new Image();
		img.onload = good; 
		img.onerror = bad;
		img.src = imageSrc;
	}      
	</script>
</head>
<body>
<div class="container-fluid" id="body">
	
</div>
</body>
</html>